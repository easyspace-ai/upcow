# VelocityFollow 策略日志分析报告
**日期**: 2025-12-25  
**市场**: bitcoin-up-or-down-december-24-1pm-et  
**日志文件**: logs/bitcoin-up-or-down-december-24-1pm-et.log

## 📊 总体统计

| 指标 | 数值 |
|------|------|
| **策略触发次数** | 1 次 |
| **手动订单检测** | 2 个订单 |
| **订单事件过滤通过** | 13 次 |
| **策略下单失败** | 1 次（FAK 订单无匹配） |
| **手动订单成交** | 2 个订单全部成交 |

## ⚡ 策略触发详情

### 触发信息
- **时间**: 2025-12-25 02:00:54
- **方向**: DOWN
- **Entry 价格**: 54c (ask)
- **Hedge 价格**: 43c
- **速度**: 0.328 cents/second
- **移动**: 3c / 9.1s
- **交易次数**: 1/1（已达上限）

### 触发条件分析
✅ **满足条件**:
- 价格变化速度: 0.328 c/s > 0.3 c/s (阈值)
- 价格移动: 3c > 3c (阈值)
- 时间窗口: 9.1s < 10s (窗口)
- 交易次数限制: 1/1（未超限）

### 下单结果
❌ **Entry Order (FAK) 失败**:
- 错误: `no orders found to match with FAK order`
- 原因: 在 54c 价格没有可匹配的卖单
- 说明: 市场流动性不足，FAK 订单无法立即成交

✅ **Hedge Order (GTC) 状态**:
- 订单ID: `0x42fbe833e67810f85fc5b6b6ff6bc49cb465d4e13bfde2b3b4b533f9595c567e`
- 状态: pending（限价单，等待成交）

## 📝 手动订单检测详情

### 订单 1
- **订单ID**: `0x4bfbe4fed9a227475a4635ebb8048d6fa144c56e232e7f90e02d9c025a9d2853`
- **类型**: BUY
- **价格**: 0.4600 (46c)
- **数量**: 5.0000 shares
- **Token**: UP
- **时间线**:
  - 02:00:53 - 收到 WebSocket 消息 (status=open)
  - 02:00:53 - 订单对象构建完成
  - 02:00:53 - 订单事件过滤通过
  - 02:03:30 - 订单成交 (status=filled, filledSize=5.0000)
- **检测状态**: ✅ 成功检测并跟踪

### 订单 2
- **订单ID**: `0x173046bfa566544d3347b4ce8ab4bb562333ae8b031a1564d70836cd1d850cb1`
- **类型**: BUY
- **价格**: 0.4300 (43c)
- **数量**: 5.0000 shares
- **Token**: UP
- **时间线**:
  - 02:00:54 - 收到 WebSocket 消息 (status=open)
  - 02:00:54 - 订单对象构建完成
  - 02:00:54 - 订单事件过滤通过
  - 02:03:38 - 订单成交 (status=filled, filledSize=5.0000)
- **检测状态**: ✅ 成功检测并跟踪

## 🔍 问题分析

### 1. FAK 订单匹配失败
**问题**: Entry order (FAK) 在 54c 价格无法找到匹配的卖单

**原因分析**:
- FAK (Fill or Kill) 订单要求立即成交，否则取消
- 在 54c 价格可能没有足够的卖单深度
- 市场流动性不足

**建议**:
- 考虑在触发前检查订单簿深度
- 或者使用 IOC (Immediate or Cancel) 订单类型
- 或者降低触发价格阈值

### 2. 交易次数限制生效
✅ **正常工作**: 
- 策略触发后，交易计数增加到 1/1
- 后续即使满足触发条件，也不会再次触发（因为已达上限）

### 3. 手动订单检测
✅ **检测成功**:
- 2 个手动订单都被正确检测到
- 订单状态变化被完整跟踪
- 订单事件过滤正常工作

## 📈 市场状态

### 价格波动
- UP: 0.4700 - 0.5400 (47c - 54c)
- DOWN: 0.4700 - 0.5300 (47c - 53c)
- 价差: 约 1-7c

### 流动性
- Entry order 在 54c 无法匹配，说明该价格流动性不足
- 手动订单在 46c 和 43c 成功成交，说明较低价格有流动性

## ✅ 系统运行状态

### 正常功能
- ✅ 策略触发逻辑正常
- ✅ 交易次数限制正常工作
- ✅ 手动订单检测正常
- ✅ 订单状态跟踪正常
- ✅ WebSocket 连接正常
- ✅ 价格事件处理正常

### 警告信息
- ⚠️ 对账告警: 手动订单在 pending 状态时，本地订单不在交易所 open 列表（这是正常的，因为订单可能已成交但状态同步延迟）

## 🎯 结论

1. **策略运行正常**: 触发逻辑、交易次数限制都正常工作
2. **手动订单检测成功**: 2 个手动订单都被正确检测和跟踪
3. **流动性问题**: Entry order 因市场流动性不足而失败，这是正常的市场行为
4. **建议**: 
   - 考虑在触发前检查订单簿深度
   - 或者调整触发价格阈值
   - 或者使用更灵活的订单类型

## 📋 实盘建议

1. **监控流动性**: 关注订单簿深度，避免在流动性不足时触发
2. **调整参数**: 如果频繁出现 FAK 订单失败，考虑调整 `maxEntryPriceCents` 或使用 IOC 订单
3. **交易次数**: 当前 `maxTradesPerCycle: 1` 配置合理，测试阶段只交易一次
4. **手动订单**: 系统能正确检测和跟踪手动订单，无需额外操作


# Bot v5.1 ç®—æ³•åˆ†æ

## ğŸ“Š ç­–ç•¥ç±»å‹å¯¹æ¯”

### Bot v5.1: åšå¸‚å•†ç­–ç•¥ï¼ˆMarket Makerï¼‰

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
- **Makerï¼ˆæŒ‚å•ï¼‰**ï¼šè¢«åŠ¨ç­‰å¾…æˆäº¤ï¼Œè·å¾—æ›´å¥½çš„ä»·æ ¼
- **Takerï¼ˆåƒå•ï¼‰**ï¼šä¸»åŠ¨æˆäº¤ï¼Œä»·æ ¼è¾ƒå·®ä½†ç«‹å³æ‰§è¡Œ
- **åº“å­˜ç®¡ç†**ï¼šé€šè¿‡åº“å­˜åæ–œåŠ¨æ€è°ƒæ•´æŠ¥ä»·
- **å®šä»·æ¨¡å‹**ï¼šåŸºäº Delta å’Œæ­£æ€åˆ†å¸ƒè®¡ç®—å…¬å¹³ä»·æ ¼

### æˆ‘ä»¬çš„ç­–ç•¥: è¶‹åŠ¿è·Ÿéšç­–ç•¥ï¼ˆVelocity Followï¼‰

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
- **Entryï¼ˆFAKï¼‰**ï¼šä¸»åŠ¨åƒå•ï¼Œç«‹å³æˆäº¤
- **Hedgeï¼ˆGTCï¼‰**ï¼šè¢«åŠ¨æŒ‚å•ï¼Œç­‰å¾…æ›´å¥½ä»·æ ¼
- **ä»·æ ¼è·Ÿéš**ï¼šåŸºäºä»·æ ¼å˜åŒ–é€Ÿåº¦ï¼ˆvelocityï¼‰åˆ¤æ–­æ–¹å‘
- **å¤šå‘¨æœŸäº¤æ˜“**ï¼šæ¯å‘¨æœŸæœ€å¤š 3 æ¬¡äº¤æ˜“

## ğŸ” æ ¸å¿ƒç®—æ³•åˆ†æ

### 1. å®šä»·æ¨¡å‹ï¼ˆBot v5.1ï¼‰

```javascript
// 1. è®¡ç®— Deltaï¼ˆä»·æ ¼åç¦»ï¼‰
const delta = fut - this.marketInfo.strikePrice;

// 2. æ—¶é—´å› å­ï¼ˆå‰©ä½™æ—¶é—´ï¼‰
const timeFactor = Math.sqrt(Math.max(1, remaining));
const rawX = delta / timeFactor;

// 3. æ¨¡å‹æ¦‚ç‡ï¼ˆæ­£æ€åˆ†å¸ƒï¼‰
const z = this.k * rawX + this.c;
const modelFairUp = MathUtils.normCdf(z);

// 4. å¸‚åœºä¸­æ¢ï¼ˆMid Priceï¼‰
const marketMidUp = (marketUp.bid + marketUp.ask) / 2;

// 5. èåˆæ¦‚ç‡ï¼ˆ70% å¸‚åœºæƒé‡ï¼‰
const finalFairUp = (1 - this.marketWeight) * modelFairUp + this.marketWeight * marketMidUp;
```

**å…³é”®å‚æ•°**ï¼š
- `k = 0.08`: æ•æ„Ÿåº¦ç³»æ•°
- `c = 0.10`: åç§»é‡
- `marketWeight = 0.7`: å¸‚åœºæƒé‡ï¼ˆ70%ï¼‰

**å€Ÿé‰´ä»·å€¼**ï¼šâ­â­â­
- âœ… å¯ä»¥è€ƒè™‘ä½¿ç”¨å¸‚åœº Mid Price ä½œä¸ºå‚è€ƒ
- âœ… å¯ä»¥è€ƒè™‘æ—¶é—´å› å­ï¼ˆå‰©ä½™æ—¶é—´ï¼‰çš„å½±å“
- âš ï¸ ä½†æˆ‘ä»¬çš„ç­–ç•¥æ˜¯è¶‹åŠ¿è·Ÿéšï¼Œä¸æ˜¯åšå¸‚ï¼Œæ‰€ä»¥å®šä»·æ¨¡å‹ä¸å¤ªé€‚ç”¨

### 2. åº“å­˜åæ–œï¼ˆInventory Skewï¼‰

```javascript
// åº“å­˜åæ–œ
const netInv = this.inventory.UP - this.inventory.DOWN;
const skew = netInv * this.inventorySkewFactor;

// åŸºäºåº“å­˜åæ–œåŠ¨æ€è°ƒæ•´æŠ¥ä»·
const resPriceUp = finalFairUp - skew;
const resPriceDown = finalFairDown + skew;
```

**é€»è¾‘**ï¼š
- å¦‚æœæŒæœ‰å¤ªå¤š UPï¼ˆnetInv > 0ï¼‰ï¼Œé™ä½ UP çš„ä¹°å…¥ä»·ï¼ˆä¸æƒ³å†ä¹°è´µçš„ï¼‰
- å¦‚æœæŒæœ‰å¤ªå¤š DOWNï¼ˆnetInv < 0ï¼‰ï¼Œé™ä½ DOWN çš„ä¹°å…¥ä»·

**å€Ÿé‰´ä»·å€¼**ï¼šâ­â­â­â­
- âœ… **éå¸¸æœ‰ä»·å€¼**ï¼šæˆ‘ä»¬çš„ç­–ç•¥ä¹Ÿåº”è¯¥è€ƒè™‘æŒä»“åæ–œ
- âœ… å¦‚æœå·²ç»æŒæœ‰å¤ªå¤šæŸä¸ªæ–¹å‘ï¼Œåº”è¯¥é™ä½è¯¥æ–¹å‘çš„äº¤æ˜“é¢‘ç‡æˆ–ä»·æ ¼
- âœ… å¯ä»¥æ·»åŠ åˆ°æˆ‘ä»¬çš„ç­–ç•¥ä¸­ï¼Œä½œä¸ºé£æ§æœºåˆ¶

### 3. åˆ†çº§ç†”æ–­æœºåˆ¶

```javascript
// åˆ†çº§ç†”æ–­å‚æ•°
this.decayStartTime = 300;      // å‰©ä½™300ç§’å¼€å§‹è¡°å‡
this.reduceOnlyTime = 300;      // å‰©ä½™300ç§’åªå‡ä¸åŠ 
this.forceCloseTime = 180;      // å‰©ä½™180ç§’å¼ºåˆ¶å¹³ä»“
this.maxEdgeAtZero = 0.02;      // ç»“æŸæ—¶è¦æ±‚çš„é¢å¤–åˆ©æ¶¦é—¨æ§›
```

**é€»è¾‘**ï¼š
- **æ­£å¸¸æœŸ**ï¼šæ­£å¸¸äº¤æ˜“
- **è¡°å‡æœŸ**ï¼ˆå‰©ä½™ 300sï¼‰ï¼šMaker Edge é€æ¸å¢åŠ 
- **å‡ä»“æœŸ**ï¼ˆå‰©ä½™ 300sï¼‰ï¼šåªå‡ä¸åŠ 
- **å¼ºåˆ¶å¹³ä»“æœŸ**ï¼ˆå‰©ä½™ 180sï¼‰ï¼šå¼ºåˆ¶å¹³ä»“

**å€Ÿé‰´ä»·å€¼**ï¼šâ­â­â­â­â­
- âœ… **éå¸¸æœ‰ä»·å€¼**ï¼šæˆ‘ä»¬å·²ç»å®ç°äº†ç±»ä¼¼çš„æœºåˆ¶ï¼ˆ`cycleEndProtectionMinutes: 3`ï¼‰
- âœ… ä½†å¯ä»¥è¿›ä¸€æ­¥ç»†åŒ–ï¼š
  - å‰©ä½™ 5 åˆ†é’Ÿï¼šå¼€å§‹è¡°å‡ï¼ˆé™ä½äº¤æ˜“é¢‘ç‡ï¼‰
  - å‰©ä½™ 3 åˆ†é’Ÿï¼šåªå‡ä¸åŠ ï¼ˆæˆ‘ä»¬å·²ç»å®ç°ï¼‰
  - å‰©ä½™ 1 åˆ†é’Ÿï¼šå¼ºåˆ¶å¹³ä»“ï¼ˆå¯ä»¥è€ƒè™‘æ·»åŠ ï¼‰

### 4. Maker vs Taker å†³ç­–

```javascript
// Takerï¼ˆä¸»åŠ¨åƒå•ï¼‰ï¼šå¸‚åœºå–ä»·æä½ï¼Œç›´æ¥ä¹°å…¥
if (marketUp.ask < resPriceUp - this.baseMinEdgeTaker) {
    action = { type: 'TAKER', side: 'UP', price: marketUp.ask, size: this.sizePerTrade };
}
// Makerï¼ˆè¢«åŠ¨æŒ‚å•ï¼‰ï¼šå¸‚åœºå–ä»·ä¸å¤Ÿä½ï¼ŒæŒ‚ä¸ªä¹°å•ç­‰åˆ«äººå–ç»™æˆ‘
else {
    const targetUpBid = marketUp.bid + 0.001; // å‹ä»·ä¸€æ¡£
    if (targetUpBid < resPriceUp - currentMakerEdge) {
        action = { type: 'MAKER', side: 'UP', price: targetUpBid, size: this.sizePerTrade };
    }
}
```

**é€»è¾‘**ï¼š
- **Taker**ï¼šå¦‚æœå¸‚åœº ask ä»·æ ¼ < ä¿ç•™ä»·æ ¼ - Taker Edgeï¼Œç›´æ¥åƒå•
- **Maker**ï¼šå¦‚æœå¸‚åœº bid ä»·æ ¼ + 0.001 < ä¿ç•™ä»·æ ¼ - Maker Edgeï¼ŒæŒ‚å•ç­‰å¾…

**å€Ÿé‰´ä»·å€¼**ï¼šâ­â­â­
- âœ… æˆ‘ä»¬çš„ç­–ç•¥å·²ç»ä½¿ç”¨äº†ç±»ä¼¼çš„é€»è¾‘ï¼š
  - Entry = FAKï¼ˆç±»ä¼¼ Takerï¼Œç«‹å³æˆäº¤ï¼‰
  - Hedge = GTCï¼ˆç±»ä¼¼ Makerï¼Œç­‰å¾…æˆäº¤ï¼‰
- âš ï¸ ä½†æˆ‘ä»¬çš„ç­–ç•¥æ˜¯è¶‹åŠ¿è·Ÿéšï¼Œä¸æ˜¯åšå¸‚ï¼Œæ‰€ä»¥ä¸éœ€è¦ Maker è®¢å•

### 5. é£æ§å¯¹å†²æœºåˆ¶

```javascript
// é£æ§å¯¹å†²
if (netInv > this.hedgeThreshold) forceActionSide = 'DOWN';
else if (netInv < -this.hedgeThreshold) forceActionSide = 'UP';

if (forceActionSide) {
    // Taker Hedgeï¼šé€šè¿‡Takerçº å
    action = {
        type: 'TAKER_HEDGE',
        side: forceActionSide,
        price: targetBook.ask,
        size: this.sizePerTrade * this.hedgeSizeMultiplier
    };
}
```

**é€»è¾‘**ï¼š
- å¦‚æœå‡€æŒä»“è¶…è¿‡é˜ˆå€¼ï¼ˆ80ï¼‰ï¼Œå¼ºåˆ¶å¯¹å†²
- ä½¿ç”¨ Taker æ–¹å¼å¿«é€Ÿå¯¹å†²

**å€Ÿé‰´ä»·å€¼**ï¼šâ­â­â­â­
- âœ… **æœ‰ä»·å€¼**ï¼šæˆ‘ä»¬çš„ç­–ç•¥ä¹Ÿåº”è¯¥è€ƒè™‘æŒä»“é£æ§
- âœ… å¦‚æœæŸä¸ªæ–¹å‘çš„æŒä»“è¿‡å¤šï¼Œåº”è¯¥é™ä½è¯¥æ–¹å‘çš„äº¤æ˜“é¢‘ç‡
- âœ… å¯ä»¥æ·»åŠ åˆ°æˆ‘ä»¬çš„ç­–ç•¥ä¸­

## ğŸ’¡ å¯¹æˆ‘ä»¬ç­–ç•¥çš„å€Ÿé‰´ä»·å€¼

### é«˜ä»·å€¼å€Ÿé‰´ï¼ˆâ­â­â­â­â­ï¼‰

1. **åˆ†çº§ç†”æ–­æœºåˆ¶**
   - âœ… æˆ‘ä»¬å·²ç»å®ç°äº†å‘¨æœŸç»“æŸå‰ä¿æŠ¤ï¼ˆ`cycleEndProtectionMinutes: 3`ï¼‰
   - ğŸ’¡ **å¯ä»¥æ”¹è¿›**ï¼šæ·»åŠ æ›´ç»†åŒ–çš„åˆ†çº§æœºåˆ¶
     - å‰©ä½™ 5 åˆ†é’Ÿï¼šå¼€å§‹è¡°å‡ï¼ˆé™ä½äº¤æ˜“é¢‘ç‡ï¼‰
     - å‰©ä½™ 3 åˆ†é’Ÿï¼šåªå‡ä¸åŠ ï¼ˆå·²å®ç°ï¼‰
     - å‰©ä½™ 1 åˆ†é’Ÿï¼šå¼ºåˆ¶å¹³ä»“ï¼ˆå¯ä»¥è€ƒè™‘ï¼‰

2. **åº“å­˜åæ–œï¼ˆInventory Skewï¼‰**
   - ğŸ’¡ **å¯ä»¥æ·»åŠ **ï¼šå¦‚æœæŸä¸ªæ–¹å‘çš„æŒä»“è¿‡å¤šï¼Œé™ä½è¯¥æ–¹å‘çš„äº¤æ˜“é¢‘ç‡
   - ğŸ’¡ **å®ç°æ–¹å¼**ï¼š
     ```go
     // è®¡ç®—å‡€æŒä»“
     netPosition := s.inventory.UP - s.inventory.DOWN
     
     // å¦‚æœå‡€æŒä»“è¶…è¿‡é˜ˆå€¼ï¼Œé™ä½è¯¥æ–¹å‘çš„äº¤æ˜“é¢‘ç‡
     if netPosition > threshold && winner == domain.TokenTypeUp {
         // è·³è¿‡æˆ–é™ä½äº¤æ˜“é¢‘ç‡
     }
     ```

### ä¸­ç­‰ä»·å€¼å€Ÿé‰´ï¼ˆâ­â­â­ï¼‰

3. **å¸‚åœº Mid Price å‚è€ƒ**
   - ğŸ’¡ **å¯ä»¥è€ƒè™‘**ï¼šä½¿ç”¨å¸‚åœº Mid Price ä½œä¸ºå‚è€ƒï¼Œè€Œä¸æ˜¯åªä½¿ç”¨ ask ä»·æ ¼
   - ğŸ’¡ **å®ç°æ–¹å¼**ï¼š
     ```go
     // è®¡ç®—å¸‚åœº Mid Price
     marketMidUp := (yesBid + yesAsk) / 2
     
     // å¦‚æœæˆ‘ä»¬çš„ä»·æ ¼åç¦» Mid Price å¤ªè¿œï¼Œå¯èƒ½éœ€è¦è°ƒæ•´
     ```

4. **æ—¶é—´å› å­**
   - ğŸ’¡ **å¯ä»¥è€ƒè™‘**ï¼šåœ¨è®¡ç®—ä»·æ ¼æ—¶è€ƒè™‘å‰©ä½™æ—¶é—´
   - ğŸ’¡ **å®ç°æ–¹å¼**ï¼š
     ```go
     // å‰©ä½™æ—¶é—´è¶Šå°‘ï¼Œä»·æ ¼å˜åŒ–çš„å½±å“è¶Šå¤§
     timeFactor := math.Sqrt(math.Max(1, remainingSeconds))
     adjustedVelocity := velocity / timeFactor
     ```

### ä½ä»·å€¼å€Ÿé‰´ï¼ˆâ­â­ï¼‰

5. **Maker/Taker å†³ç­–**
   - âš ï¸ æˆ‘ä»¬çš„ç­–ç•¥å·²ç»ä½¿ç”¨äº†ç±»ä¼¼çš„é€»è¾‘ï¼ˆFAK vs GTCï¼‰
   - âš ï¸ ä½†æˆ‘ä»¬çš„ç­–ç•¥æ˜¯è¶‹åŠ¿è·Ÿéšï¼Œä¸æ˜¯åšå¸‚ï¼Œæ‰€ä»¥ä¸éœ€è¦ Maker è®¢å•

6. **å®šä»·æ¨¡å‹**
   - âš ï¸ Bot v5.1 çš„å®šä»·æ¨¡å‹åŸºäº Delta å’Œæ­£æ€åˆ†å¸ƒï¼Œé€‚åˆåšå¸‚å•†ç­–ç•¥
   - âš ï¸ æˆ‘ä»¬çš„ç­–ç•¥æ˜¯è¶‹åŠ¿è·Ÿéšï¼ŒåŸºäºä»·æ ¼å˜åŒ–é€Ÿåº¦ï¼Œæ‰€ä»¥ä¸å¤ªé€‚ç”¨

## ğŸ¯ å…·ä½“æ”¹è¿›å»ºè®®

### å»ºè®® 1: æ·»åŠ åº“å­˜åæ–œæœºåˆ¶

```go
// åœ¨ OnPriceChanged ä¸­æ·»åŠ 
netPosition := s.inventory.UP - s.inventory.DOWN
inventoryThreshold := 50.0 // é…ç½®å‚æ•°

// å¦‚æœå‡€æŒä»“è¶…è¿‡é˜ˆå€¼ï¼Œé™ä½è¯¥æ–¹å‘çš„äº¤æ˜“é¢‘ç‡
if netPosition > inventoryThreshold && winner == domain.TokenTypeUp {
    log.Debugf("ğŸ”„ [%s] è·³è¿‡ï¼šUP æ–¹å‘æŒä»“è¿‡å¤šï¼ˆå‡€æŒä»“=%.2f > %.2fï¼‰", ID, netPosition, inventoryThreshold)
    return nil
}
if netPosition < -inventoryThreshold && winner == domain.TokenTypeDown {
    log.Debugf("ğŸ”„ [%s] è·³è¿‡ï¼šDOWN æ–¹å‘æŒä»“è¿‡å¤šï¼ˆå‡€æŒä»“=%.2f < %.2fï¼‰", ID, netPosition, -inventoryThreshold)
    return nil
}
```

### å»ºè®® 2: ç»†åŒ–å‘¨æœŸç»“æŸä¿æŠ¤

```go
// åœ¨ OnPriceChanged ä¸­æ·»åŠ 
remainingSeconds := time.Until(cycleEndTime).Seconds()

// åˆ†çº§ä¿æŠ¤
if remainingSeconds < 60 {
    // å‰©ä½™ 1 åˆ†é’Ÿï¼šå¼ºåˆ¶å¹³ä»“
    log.Infof("â¸ï¸ [%s] è·³è¿‡ï¼šå‘¨æœŸç»“æŸå‰ 1 åˆ†é’Ÿï¼Œå¼ºåˆ¶å¹³ä»“æœŸ", ID)
    return nil
} else if remainingSeconds < 180 {
    // å‰©ä½™ 3 åˆ†é’Ÿï¼šåªå‡ä¸åŠ ï¼ˆå·²å®ç°ï¼‰
    // ...
} else if remainingSeconds < 300 {
    // å‰©ä½™ 5 åˆ†é’Ÿï¼šå¼€å§‹è¡°å‡ï¼ˆé™ä½äº¤æ˜“é¢‘ç‡ï¼‰
    // å¯ä»¥å¢åŠ å†·å´æ—¶é—´æˆ–é™ä½äº¤æ˜“é¢‘ç‡
}
```

### å»ºè®® 3: ä½¿ç”¨å¸‚åœº Mid Price ä½œä¸ºå‚è€ƒ

```go
// åœ¨è®¡ç®—ä»·æ ¼æ—¶
yesMidPrice := (yesBid + yesAsk) / 2
noMidPrice := (noBid + noAsk) / 2

// å¦‚æœæˆ‘ä»¬çš„ä»·æ ¼åç¦» Mid Price å¤ªè¿œï¼Œå¯èƒ½éœ€è¦è°ƒæ•´
// æˆ–è€…ä½¿ç”¨ Mid Price ä½œä¸ºå‚è€ƒï¼Œè€Œä¸æ˜¯åªä½¿ç”¨ ask ä»·æ ¼
```

## ğŸ“‹ æ€»ç»“

### é«˜ä»·å€¼å€Ÿé‰´
1. âœ… **åº“å­˜åæ–œæœºåˆ¶**ï¼šéå¸¸æœ‰ä»·å€¼ï¼Œå¯ä»¥æ·»åŠ åˆ°æˆ‘ä»¬çš„ç­–ç•¥ä¸­
2. âœ… **åˆ†çº§ç†”æ–­æœºåˆ¶**ï¼šæˆ‘ä»¬å·²ç»å®ç°äº†åŸºç¡€ç‰ˆæœ¬ï¼Œå¯ä»¥è¿›ä¸€æ­¥ç»†åŒ–

### ä¸­ç­‰ä»·å€¼å€Ÿé‰´
3. âš ï¸ **å¸‚åœº Mid Price å‚è€ƒ**ï¼šå¯ä»¥è€ƒè™‘ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„
4. âš ï¸ **æ—¶é—´å› å­**ï¼šå¯ä»¥è€ƒè™‘ï¼Œä½†æˆ‘ä»¬çš„ç­–ç•¥å·²ç»è€ƒè™‘äº†æ—¶é—´ï¼ˆvelocityï¼‰

### ä½ä»·å€¼å€Ÿé‰´
5. âŒ **Maker/Taker å†³ç­–**ï¼šæˆ‘ä»¬å·²ç»ä½¿ç”¨äº†ç±»ä¼¼çš„é€»è¾‘
6. âŒ **å®šä»·æ¨¡å‹**ï¼šä¸é€‚åˆæˆ‘ä»¬çš„è¶‹åŠ¿è·Ÿéšç­–ç•¥

### æ ¸å¿ƒå·®å¼‚

| ç‰¹æ€§ | Bot v5.1 | æˆ‘ä»¬çš„ç­–ç•¥ |
|------|----------|-----------|
| ç­–ç•¥ç±»å‹ | åšå¸‚å•†ï¼ˆMarket Makerï¼‰ | è¶‹åŠ¿è·Ÿéšï¼ˆTrend Followingï¼‰ |
| äº¤æ˜“æ–¹å¼ | Maker + Taker | FAK + GTC |
| å®šä»·æ¨¡å‹ | Delta + æ­£æ€åˆ†å¸ƒ | ä»·æ ¼å˜åŒ–é€Ÿåº¦ï¼ˆVelocityï¼‰ |
| ç›®æ ‡ | èµšå–ä»·å·®ï¼ˆSpreadï¼‰ | èµšå–æ³¢åŠ¨ï¼ˆVolatilityï¼‰ |
| æŒä»“ç®¡ç† | åº“å­˜åæ–œ | å¯¹å†²å• |

**ç»“è®º**ï¼šBot v5.1 çš„**åº“å­˜åæ–œæœºåˆ¶**å’Œ**åˆ†çº§ç†”æ–­æœºåˆ¶**å¯¹æˆ‘ä»¬å¾ˆæœ‰ä»·å€¼ï¼Œå¯ä»¥è€ƒè™‘æ·»åŠ åˆ°æˆ‘ä»¬çš„ç­–ç•¥ä¸­ã€‚


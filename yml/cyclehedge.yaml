# cyclehedge：5000U 测试版（BTC 15m）
#
# 说明：
# - 每周期固定投入 5000 USDC（fixedNotionalUSDC）
# - 距离结算 3 分钟（180s）停止开新仓并撤单（entryCutoffSeconds）
#
log_level: info
persistence_dir: data/state/cyclehedge-test-50
# 市场配置（可从策略配置文件读取，会覆盖主配置文件中的设置）
market:
  symbol: "btc"
  timeframe: "15m"
  kind: "updown"

# 纸交易模式（可从策略配置文件读取，会覆盖主配置文件中的设置）
# true = 仅模拟交易，false = 真实交易
dry_run: true

exchangeStrategies:
  - on: polymarket
    cyclehedge:
      # 资金规模：测试期固定 5000 USDC
      fixedNotionalUSDC: 5000
      minNotionalUSDC: 30
      maxNotionalUSDC: 6000

      # 目标收益：1-4 cents（动态挑选）
      profitMinCents: 1
      profitMaxCents: 4
      enableDynamicProfit: true
      distancePenaltyBps: 30

      # 最后 3 分钟：不新增，只补齐/去风险 180s
      entryCutoffSeconds: 180

      # 裸露控制（结合你的最小单限制）
      minUnhedgedShares: 5                # 让策略不要去下 <5 shares 的 GTC（避免被自动抬到 5 导致意外放大）
      unhedgedTimeoutSeconds: 10
      maxUnhedgedSharesBudget: 10         # 裸露预算（策略内部会随时间动态收紧）
      maxSingleSideShares: 80             # 单边上限，避免只成交一腿越滚越大
      maxOrderSizeShares: 10              # 单笔最大 shares（小资金建议保守）

      # 补齐：maker 优先 + 追价 + 尾盘可贴 ask-1（仍 maker）
      enableMakerSupplement: true
      makerSupplementWindowSeconds: 3
      makerSupplementBumpCents: 1
      makerSupplementMinShares: 5
      enableMakerSupplementSnapToAskMinusOne: true

      # 兜底：允许 taker 补齐 / 回平（会按“补齐 vs 回平”成本收益自动选择）
      allowTakerComplete: true
      allowFlatten: true
      minProfitAfterCompleteCents: 1

      # 盘口质量 gate（建议开着）
      enableMarketQualityGate: false
      marketQualityMinScore: 70
      marketQualityMaxSpreadCents: 5
      marketQualityMaxBookAgeMs: 3000

      # 报表（可选）
      enableReport: true
      reportDir: data/reports/cyclehedge
      reportWriteJSONL: true
      reportWritePerCycle: true

      # 自动 merge（测试期先关，避免复杂度）
      autoMerge:
        enabled: false

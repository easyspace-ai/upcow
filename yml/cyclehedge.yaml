# cyclehedge：40U 测试版（BTC 15m）
#
# 说明：
# - 每周期固定投入 40 USDC（fixedNotionalUSDC）
# - 距离结算 3 分钟（180s）停止开新仓并撤单（entryCutoffSeconds）
#

# 市场配置（可从策略配置文件读取，会覆盖主配置文件中的设置）
market:
  symbol: "btc"
  timeframe: "15m"
  kind: "updown"

# 纸交易模式（可从策略配置文件读取，会覆盖主配置文件中的设置）
# true = 仅模拟交易，false = 真实交易
dry_run: true


exchangeStrategies:
  - on: polymarket
    cyclehedge:
      # 周期长度：15m
      cycleDurationSeconds: 900

      # 锁利目标（分）：测试期建议更偏“容易成交”
      profitMinCents: 1
      profitMaxCents: 3
      enableDynamicProfit: true
      distancePenaltyBps: 40

      # 每周期资金量（USDC notional）：固定 40U（不随余额滚动）
      fixedNotionalUSDC: 40
      # 下方滚动参数在 fixedNotionalUSDC>0 时不会生效，但保留默认值便于切换
      minNotionalUSDC: 30
      maxNotionalUSDC: 3000
      balanceAllocationPct: 0.8

      # 距离结算 3 分钟：停止开新仓并撤单
      entryCutoffSeconds: 180

      # 每周期最大单向持仓（shares）：40U 情况下正常在几十 shares 级别，这里给一个保守上限
      maxSingleSideShares: 50
      
      # 单笔最大下单数量（shares）：硬风控，避免单笔失控
      maxOrderSizeShares: 8
      
      # 方向偏好：两腿都要下单时，优先下盘口价格更高且 >= 阈值的一腿（例如 60c）
      # 用于减少“只成交一腿时拿错方向”的概率。0 表示关闭。
      preferHighPriceThresholdCents: 60

      # 报价刷新
      requoteMs: 1000

      # 单腿裸露自救
      minProfitAfterCompleteCents: 0
      unhedgedTimeoutSeconds: 10
      allowTakerComplete: true
      allowFlatten: true
      minUnhedgedShares: 1

      # 盘口质量 gate（建议开启）
      enableMarketQualityGate: true
      marketQualityMinScore: 70
      marketQualityMaxSpreadCents: 5
      marketQualityMaxBookAgeMs: 3000

      # 周期报表：写入 data/reports/cyclehedge/
      enableReport: true
      reportDir: "data/reports/cyclehedge"
      reportWriteJSONL: true
      reportWritePerCycle: true

